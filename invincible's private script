-- Load UI Library
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library", true))()
local window = library:AddWindow("Invincibles Priv Script", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = false,
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Wait for muscleEvent
local muscleEvent = nil
local function getMuscleEvent()
    muscleEvent = LocalPlayer:FindFirstChild("muscleEvent") or workspace:FindFirstChild("muscleEvent")
    if not muscleEvent then
        print("muscleEvent not found yet, retrying...")
    end
end
getMuscleEvent()

-- Repeat until muscleEvent is found
task.spawn(function()
    while not muscleEvent do
        getMuscleEvent()
        wait(1)
    end
    print("muscleEvent found:", muscleEvent)
end)

-- Helper: Teleport
local function tpTo(pos)
    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if hrp then
        hrp.CFrame = CFrame.new(pos)
        print("Teleported to", pos)
    end
end

-- UI Tabs
local main = window:AddTab("Main")
local ToolsFolder = main:AddFolder("Tools")
local TeleportTab = window:AddTab("Teleport")
local KillTab = window:AddTab("Kill")
local MiscTab = window:AddTab("Misc")
local rebirthTab = window:AddTab("Rebirth")
local farmTab = window:AddTab("Auto Farm")


----------------------------------------
-- Teleport Buttons
TeleportTab:AddButton("To Spawn / Safe", function() tpTo(Vector3.new(-6, 5, -196)) end)
TeleportTab:AddButton("To Secret Area", function() tpTo(Vector3.new(1947, 2, 6191)) end)
-- add more as needed

----------------------------------------
-- Auto Rebirth
local autoRebirth = false
local function autoRebirthLoop()
    while autoRebirth do
        pcall(function()
            local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
            if rEvents and rEvents:FindFirstChild("rebirthRemote") then
                rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                print("Rebirth requested")
            end
        end)
        wait(0.1)
    end
end

rebirthTab:AddSwitch("Auto Rebirth", function(state)
    autoRebirth = state
    if state then
        task.spawn(autoRebirthLoop)
        print("Auto Rebirth activated")
    end
end)

----------------------------------------
-- Kill All Players
local killAll = false
local function killAllLoop()
    while killAll do
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character then
                local hrp = plr.Character:FindFirstChild("HumanoidRootPart")
                local myHRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if hrp and myHRP then
                    firetouchinterest(hrp, myHRP, 0)
                    firetouchinterest(hrp, myHRP, 1)
                end
            end
        end
        wait(0.1)
    end
end

local killFolder = KillTab:AddFolder("Auto Kill")
killFolder:AddSwitch("Kill All Players", function(state)
    killAll = state
    if state then task.spawn(killAllLoop) end
end)

local targetPlayer = nil
local dropdown = killFolder:AddDropdown("Target Player", {
    Values = {},
    Callback = function(val)
        targetPlayer = val
        print("Target set:", val)
    end
})

killFolder:AddSwitch("Auto Kill Target", function(state)
    getgenv().autoKillTarget = state
    if state and targetPlayer then
        task.spawn(function()
            while getgenv().autoKillTarget do
                local target = Players:FindFirstChild(targetPlayer)
                if target then
                    local hrp = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                    local myHRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and myHRP then
                        firetouchinterest(hrp, myHRP, 0)
                        firetouchinterest(hrp, myHRP, 1)
                    end
                end
                wait(0.08)
            end
        end)
    end
end)

-- update dropdown list
task.spawn(function()
    while true do
        local list = {}
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer then
                table.insert(list, plr.Name)
            end
        end
        pcall(function()
            dropdown:SetValues(list)
        end)
        wait(5)
    end
end)

----------------------------------------
-- Infinite Jump
MiscTab:AddSwitch("Infinite Jump", function(state)
    getgenv().infJump = state
end)

UserInputService.JumpRequest:Connect(function()
    if getgenv().infJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)

----------------------------------------
-- Auto Farm Rocks (example)
local autoFarm = false
local targetDurability = 0
local function autoFarmRocks(durability)
    while autoFarm do
        for _, v in pairs(workspace:FindFirstChild("machinesFolder") and workspace.machinesFolder:GetDescendants() or {}) do
            if v.Name == "neededDurability" and v.Value == durability then
                local rock = v.Parent:FindFirstChild("Rock")
                local char = LocalPlayer.Character
                if rock and char and char:FindFirstChild("RightHand") and char:FindFirstChild("LeftHand") then
                    firetouchinterest(rock, char.RightHand, 0)
                    firetouchinterest(rock, char.RightHand, 1)
                    firetouchinterest(rock, char.LeftHand, 0)
                    firetouchinterest(rock, char.LeftHand, 1)
                    -- auto punch while farming
                    if _G.FastPunch then
                        if muscleEvent then
                            muscleEvent:FireServer("punch", "rightHand")
                            muscleEvent:FireServer("punch", "leftHand")
                        end
                        local punch = char:FindFirstChild("Punch")
                        if punch then punch:Activate() end
                    end
                end
            end
        end
        wait(0.15)
    end
end

local rockFarmFolder = farmTab:AddFolder("Rock Farm")
rockFarmFolder:AddSwitch("Farm Rock (durability 0)", {
    Default = false,
    Callback = function(val)
        autoFarm = val
        if val then autoFarmRocks(0) end
    end
})

-- Fast Punch with auto-equip
Tools:AddSwitch("Fast Punch", function(state)
    _G.FastPunch = state
    if state then
        task.spawn(function()
            -- Auto equip punch
            local function equipPunch()
                local char = LocalPlayer.Character
                if not char then return end
                local punchTool = LocalPlayer.Backpack:FindFirstChild("Punch")
                if punchTool then
                    punchTool.Parent = char
                end
            end
            equipPunch()
            while _G.FastPunch do
                pcall(function()
                    if muscleEvent then
                        muscleEvent:FireServer("punch", "rightHand")
                        muscleEvent:FireServer("punch", "leftHand")
                    end
                    local char = LocalPlayer.Character
                    if not char:FindFirstChild("Punch") then
                        local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
                        if punch then punch.Parent = char end
                    end
                    local punch = char:FindFirstChild("Punch")
                    if punch then punch:Activate() end
                end)
                wait(0.07)
            end
        end)
    end
end)
