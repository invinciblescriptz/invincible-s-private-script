local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library"))()

local window = library:AddWindow("Invincible Paid", {
    main_color = Color3.fromRGB(139, 0, 0), -- Blood Red
    min_size   = Vector2.new(520, 520),
    can_resize = false,
})

-- Services
local Players           = game:GetService("Players")
local LocalPlayer       = Players.LocalPlayer
local Workspace         = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService  = game:GetService("UserInputService")
local RunService        = game:GetService("RunService")
local VirtualUser       = game:GetService("VirtualUser")

local muscleEvent = LocalPlayer:WaitForChild("muscleEvent", 10)

-- Globals & states
getgenv().NexusRunning = true

local states = {
    AutoPushups       = false,
    AutoWeight        = false,
    AutoHandstands    = false,
    FastPunch         = false,
    FastStrength      = false,
    InfiniteJump      = false,
    AutoRebirth       = false,
    AutoRebirthTarget = false,
    KillAura          = false,
    AutoKillSelected  = false,
    AntiAfk           = false,
}

local targetRebirths = 1
local selectedTarget = nil

-- Rock farm
getgenv().rockFarmActive         = false
getgenv().selectedRockDurability = 0

-- =============================================================
-- Helpers
-- =============================================================
local function tpTo(pos)
    pcall(function()
        local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.CFrame = CFrame.new(pos) end
    end)
end

local function startAutoRep(toolName, stateKey)
    task.spawn(function()
        while states[stateKey] and getgenv().NexusRunning do
            pcall(function()
                local char = LocalPlayer.Character
                if not char or not char:FindFirstChild("Humanoid") or char.Humanoid.Health <= 0 then
                    task.wait(1.5) return
                end
                local tool = LocalPlayer.Backpack:FindFirstChild(toolName) or char:FindFirstChild(toolName)
                if tool and tool.Parent ~= char then
                    char.Humanoid:EquipTool(tool)
                end
                if muscleEvent then muscleEvent:FireServer("rep") end
            end)
            task.wait(0.08)
        end
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild(toolName) then
                char[toolName].Parent = LocalPlayer.Backpack
            end
        end)
    end)
end

-- Fast Strength
local fastStrengthConn
local function toggleFastStrength(state)
    states.FastStrength = state
    if state then
        if fastStrengthConn then fastStrengthConn:Disconnect() end
        fastStrengthConn = RunService.Heartbeat:Connect(function()
            pcall(function()
                if muscleEvent then
                    muscleEvent:FireServer("rep")
                    muscleEvent:FireServer("punch", "rightHand")
                    muscleEvent:FireServer("punch", "leftHand")
                end
                local char = LocalPlayer.Character
                if char then
                    local tool = char:FindFirstChildWhichIsA("Tool")
                    if tool then tool:Activate() end
                end
            end)
        end)
    else
        if fastStrengthConn then fastStrengthConn:Disconnect() fastStrengthConn = nil end
    end
end

-- Infinite Jump
local jumpConn
local function toggleInfiniteJump(state)
    states.InfiniteJump = state
    if state then
        if jumpConn then return end
        jumpConn = UserInputService.JumpRequest:Connect(function()
            pcall(function()
                local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
            end)
        end)
    else
        if jumpConn then jumpConn:Disconnect() jumpConn = nil end
    end
end

-- Anti-AFK (working 2026 method)
local antiAfkConn
local function toggleAntiAfk(state)
    states.AntiAfk = state
    if state then
        if antiAfkConn then return end
        antiAfkConn = LocalPlayer.Idled:Connect(function()
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end)
    else
        if antiAfkConn then antiAfkConn:Disconnect() antiAfkConn = nil end
    end
end

-- Simple Kill Player (position under target - reliable)
local function killPlayer(target)
    pcall(function()
        local myChar = LocalPlayer.Character
        local tChar = target.Character
        if not myChar or not tChar then return end
        local myHRP = myChar:FindFirstChild("HumanoidRootPart")
        local tHRP = tChar:FindFirstChild("HumanoidRootPart")
        if myHRP and tHRP then
            myHRP.CFrame = tHRP.CFrame * CFrame.new(0, -25, 0)
        end
    end)
end

-- =============================================================
-- Tabs & Folders
-- =============================================================
local mainTab     = window:AddTab("Main")
local farmingTab  = window:AddTab("Better Farming")
local rebirthTab  = window:AddTab("Rebirth")
local teleportTab = window:AddTab("Teleport")
local StatsTab = window:AddTab("Stats")
local killerTab   = window:AddTab("Killer")
local miscTab     = window:AddTab("Misc")

local toolsFolder    = mainTab:AddFolder("Tools")
local rockFarmFolder = mainTab:AddFolder("Rock Farm")
local killFolder     = killerTab:AddFolder("Auto Kill")
local Brawl FarmingFolder = miscTab:AddFolder("Brawl Farming")

-- Tools switches (unchanged except safer delay)
toolsFolder:AddSwitch("Auto Pushups",    function(s) states.AutoPushups = s    if s then startAutoRep("Pushups",    "AutoPushups")    end end)
toolsFolder:AddSwitch("Auto Weight",     function(s) states.AutoWeight = s     if s then startAutoRep("Weight",     "AutoWeight")     end end)
toolsFolder:AddSwitch("Auto Handstands", function(s) states.AutoHandstands = s if s then startAutoRep("Handstands", "AutoHandstands") end end)

toolsFolder:AddSwitch("Auto Punch (Fast)", function(s)
    states.FastPunch = s
    if s then
        task.spawn(function()
            while states.FastPunch and getgenv().NexusRunning do
                pcall(function()
                    if muscleEvent then
                        muscleEvent:FireServer("punch", "rightHand")
                        muscleEvent:FireServer("punch", "leftHand")
                    end
                    local char = LocalPlayer.Character
                    if char then
                        local punch = char:FindFirstChild("Punch") or LocalPlayer.Backpack:FindFirstChild("Punch")
                        if punch and punch.Parent ~= char then char.Humanoid:EquipTool(punch) end
                        if punch and punch.Parent == char then
                            local atk = punch:FindFirstChild("attackTime")
                            if atk and atk:IsA("NumberValue") then atk.Value = 0.01 end
                            punch:Activate()
                        end
                    end
                end)
                task.wait(0.09)
            end
        end)
    end
end)

toolsFolder:AddButton("Anti Lag (Boost FPS)", function()
    local Lighting = game:GetService("Lighting")
    Lighting.GlobalShadows = false
    Lighting.Brightness = 1
    Lighting.ClockTime = 12
    Lighting.FogEnd = 9999
    Lighting.FogStart = 0
    for _, v in pairs(Workspace:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Smoke") or v:IsA("Fire") or v:IsA("Sparkles") or
           v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("DepthOfFieldEffect") or v:IsA("SunRaysEffect") then
            v.Enabled = false
        end
    end
    settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
end)

toolsFolder:AddButton("Free AutoLift Gamepass", function()
    pcall(function()
        local gpFolder = ReplicatedStorage:FindFirstChild("gamepassIds")
        if gpFolder then
            local owned = LocalPlayer:FindFirstChild("ownedGamepasses") or Instance.new("Folder")
            owned.Name = "ownedGamepasses"
            owned.Parent = LocalPlayer
            for _, gp in pairs(gpFolder:GetChildren()) do
                local val = Instance.new("IntValue")
                val.Name = gp.Name
                val.Value = gp.Value
                val.Parent = owned
            end
        end
    end)
end)

-- Teleport Tab (unchanged)
teleportTab:AddButton("To Spawn / Safe Area", function() tpTo(Vector3.new(-6, 5, -196)) end)
teleportTab:AddButton("To Secret Area",       function() tpTo(Vector3.new(1947, 2, 6191)) end)
teleportTab:AddButton("To Tiny Area",         function() tpTo(Vector3.new(-39, 6, 1886)) end)
teleportTab:AddButton("To Frozen Area",       function() tpTo(Vector3.new(-2623, 6, -409)) end)
teleportTab:AddButton("To Mythical Area",     function() tpTo(Vector3.new(2251, 6, 1073)) end)
teleportTab:AddButton("To Inferno Area",      function() tpTo(Vector3.new(-6759, 6, -1285)) end)
teleportTab:AddButton("To Legend Area",       function() tpTo(Vector3.new(4603, 990, -3898)) end)
teleportTab:AddButton("To Muscle King Area",  function() tpTo(Vector3.new(-8626, 16, -5730)) end)
teleportTab:AddButton("To Jungle Area",       function() tpTo(Vector3.new(-8642, 6, 2381)) end)
teleportTab:AddButton("To Lava Brawl",        function() tpTo(Vector3.new(4471, 119, -8836)) end)
teleportTab:AddButton("To Desert Brawl",      function() tpTo(Vector3.new(960, 17, -7398)) end)
teleportTab:AddButton("To Beach Brawl",       function() tpTo(Vector3.new(-1849, 20, -6335)) end)

-- Rock Farm Loop (single active)
task.spawn(function()
    while getgenv().NexusRunning do
        if not getgenv().rockFarmActive or getgenv().selectedRockDurability <= 0 then
            task.wait(0.6) continue
        end
        pcall(function()
            local char = LocalPlayer.Character
            if not char or not char:FindFirstChild("Humanoid") or char.Humanoid.Health <= 0 then task.wait(1.2) return end
            local dur = LocalPlayer:FindFirstChild("Durability")
            if not dur or dur.Value < getgenv().selectedRockDurability then task.wait(0.5) return end
            local hum = char.Humanoid
            local punch = char:FindFirstChild("Punch") or LocalPlayer.Backpack:FindFirstChild("Punch")
            if hum and punch and punch.Parent ~= char then hum:EquipTool(punch) end
            local touched = false
            for _, obj in pairs(Workspace.machinesFolder:GetDescendants()) do
                if obj.Name == "neededDurability" and obj:IsA("IntValue") and obj.Value == getgenv().selectedRockDurability then
                    local rock = obj.Parent:FindFirstChild("Rock")
                    if rock and rock:IsA("BasePart") then
                        touched = true
                        if char:FindFirstChild("RightHand") then
                            firetouchinterest(rock, char.RightHand, 0) task.wait(0.025) firetouchinterest(rock, char.RightHand, 1)
                        end
                        if char:FindFirstChild("LeftHand") then
                            firetouchinterest(rock, char.LeftHand, 0) task.wait(0.025) firetouchinterest(rock, char.LeftHand, 1)
                        end
                    end
                end
            end
            if touched and muscleEvent then
                muscleEvent:FireServer("punch", "leftHand")
                muscleEvent:FireServer("punch", "rightHand")
            end
        end)
        task.wait(0.15)
    end
end)

local function setRockFarm(dur, s)
    if s then
        getgenv().selectedRockDurability = dur
        getgenv().rockFarmActive = true
    else
        if getgenv().selectedRockDurability == dur then
            getgenv().rockFarmActive = false
            getgenv().selectedRockDurability = 0
        end
    end
end

rockFarmFolder:AddSwitch("Farm Tiny Island Rock (0)",       function(s) setRockFarm(0, s) end)
rockFarmFolder:AddSwitch("Farm Starter Island Rock (100)",  function(s) setRockFarm(100, s) end)
rockFarmFolder:AddSwitch("Farm Legend Beach Rock (5000)",   function(s) setRockFarm(5000, s) end)
rockFarmFolder:AddSwitch("Farm Frost Gym Rock (150k)",      function(s) setRockFarm(150000, s) end)
rockFarmFolder:AddSwitch("Farm Mythical Gym Rock (400k)",   function(s) setRockFarm(400000, s) end)
rockFarmFolder:AddSwitch("Farm Eternal Gym Rock (750k)",    function(s) setRockFarm(750000, s) end)
rockFarmFolder:AddSwitch("Farm Legend Gym Rock (1M)",       function(s) setRockFarm(1000000, s) end)
rockFarmFolder:AddSwitch("Farm Muscle King Gym Rock (5M)",  function(s) setRockFarm(5000000, s) end)
rockFarmFolder:AddSwitch("Farm Ancient Jungle Rock (10M)",  function(s) setRockFarm(10000000, s) end)

rockFarmFolder:AddButton("STOP All Rock Farming", function()
    getgenv().rockFarmActive = false
    getgenv().selectedRockDurability = 0
end)

-- Killer Tab
killerTab:AddSwitch("Kill Aura (All)", function(s)
    states.KillAura = s
    if s then
        task.spawn(function()
            while states.KillAura and getgenv().NexusRunning do
                for _, plr in Players:GetPlayers() do
                    if plr ~= LocalPlayer then killPlayer(plr) end
                end
                task.wait(0.12)
            end
        end)
    end
end)

local playerDropdown = killerTab:AddDropdown("Select Target", function(val)
    selectedTarget = val and val:match("^([^|]+)") or nil
end)

killerTab:AddSwitch("Auto Kill Selected", function(s)
    states.AutoKillSelected = s
    if s and selectedTarget then
        task.spawn(function()
            while states.AutoKillSelected and getgenv().NexusRunning do
                local plr = Players:FindFirstChild(selectedTarget)
                if plr then killPlayer(plr) end
                task.wait(0.12)
            end
        end)
    end
end)

task.spawn(function()
    while getgenv().NexusRunning do
        local opts = {}
        for _, plr in Players:GetPlayers() do
            if plr ~= LocalPlayer then
                table.insert(opts, plr.Name .. " | " .. (plr.DisplayName or plr.Name))
            end
        end
        playerDropdown:SetValues(opts)
        task.wait(6)
    end
end)

-- Better Farming
farmingTab:AddSwitch("Fast Grind / Strength", toggleFastStrength)

-- Misc
miscTab:AddSwitch("Infinite Jump", toggleInfiniteJump)
miscTab:AddSwitch("Anti-AFK", toggleAntiAfk)

-- Rebirth Tab
Rebirth:AddSwitch("Auto Rebirth (Infinite)", function(s)
    states.AutoRebirth = s
    if s then
        task.spawn(function()
            while states.AutoRebirth and getgenv().NexusRunning do
                pcall(function()
                    local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
                    if rEvents and rEvents:FindFirstChild("rebirthRemote") then
                        rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                    end
                end)
                task.wait(0.1)
            end
        end)
    end
end)

Rebirth:AddInput("Target Rebirths", function(value)
    local num = tonumber(value)
    targetRebirths = num and num > 0 and num or 1
end)

Rebirth:AddSwitch("Auto Rebirth to Target", function(s)
    states.AutoRebirthTarget = s
    if s then
        task.spawn(function()
            while states.AutoRebirthTarget and getgenv().NexusRunning do
                pcall(function()
                    local rebirths = LocalPlayer.leaderstats and LocalPlayer.leaderstats:FindFirstChild("Rebirths")
                    if rebirths and rebirths.Value >= targetRebirths then
                        states.AutoRebirthTarget = false
                        return
                    end
                    local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
                    if rEvents and rEvents:FindFirstChild("rebirthRemote") then
                        rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                    end
                end)
                task.wait(0.12)
            end
        end)
    end
end)

Rebirth:AddSwitch("Auto Size 2", function(s)
    if s then
        getgenv().sizeLoop = task.spawn(function()
            while getgenv().NexusRunning do
                pcall(function()
                    local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
                    if rEvents and rEvents:FindFirstChild("changeSpeedSizeRemote") then
                        rEvents.changeSpeedSizeRemote:InvokeServer("changeSize", 2)
                    end
                end)
                task.wait(0.08)
            end
        end)
    else
        if getgenv().sizeLoop then task.cancel(getgenv().sizeLoop) getgenv().sizeLoop = nil end
    end
end)

Rebirth:AddSwitch("Auto TP Muscle King", function(s)
    if s then
        getgenv().kingTpLoop = task.spawn(function()
            while getgenv().NexusRunning do
                tpTo(Vector3.new(-8646, 17, -5738))
                task.wait(0.15)
            end
        end)
    else
        if getgenv().kingTpLoop then task.cancel(getgenv().kingTpLoop) getgenv().kingTpLoop = nil end
    end
end)

-- Optional: Pet Unequip (call manually if needed)
local function unequipAllPets()
    pcall(function()
        local petsFolder = LocalPlayer:FindFirstChild("petsFolder")
        if not petsFolder then return end
        local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
        if not rEvents then return end
        local equipEvent = rEvents:FindFirstChild("equipPetEvent")
        if not equipEvent then return end
        
        for _, folder in pairs(petsFolder:GetChildren()) do
            if folder:IsA("Folder") then
                for _, pet in pairs(folder:GetChildren()) do
                    equipEvent:FireServer("unequipPet", pet)
                end
            end
        end
    end)
end

-- Call unequipAllPets() somewhere if you want to add a button for it, e.g.:
-- miscTab:AddButton("Unequip All Pets", unequipAllPets)

print("Invincibles Priv Script â€“ fixed & safer (Feb 2026)")

local IntSection = Tabs.Stats:CreateSection("Player Stats")
local RunService = game:GetService("RunService")
local player = game.Players.LocalPlayer

local startTime = 0
local sessionStartTime = os.time()
local timerRunning = false

local strengthGained = 0
local lastStrengthValue = nil
local rebirthsGained = 0
local lastRebirthsValue = nil
local killsGained = 0
local lastKillsValue = nil
local brawlsGained = 0
local lastBrawlsValue = nil
local goodKarmaGained = 0
local lastGoodKarmaValue = nil
local evilKarmaGained = 0
local lastEvilKarmaValue = nil
local durabilityGained = 0
local lastDurabilityValue = nil
local agilityGained = 0
local lastAgilityValue = nil
local muscleKingTimeGained = 0
local lastMuscleKingTimeValue = nil

local Toggle = Folder.Brawl Farming:AddToggle("Auto Join Brawl Toggle", {
	Title = "Auto Join Brawl",
	Default = false,
	Callback = function(v)
		getgenv().joinbrawl = v
		while getgenv().joinbrawl do
			wait()
			game:GetService("ReplicatedStorage").rEvents.brawlEvent:FireServer("joinBrawl")
		end
	end
})

Tabs.Stats:CreateButton{
	Title = "Track Player",
	Description = "Start tracking selected player's stats",
	Callback = function()
		local foundPlayer = nil
		for _, player in pairs(game.Players:GetPlayers()) do
			local nameLower = player.Name:lower()
			local displayLower = player.DisplayName:lower()
			local searchLower = targetPlayer:lower()
			if nameLower:find(searchLower) or displayLower:find(searchLower) then
				foundPlayer = player
				break
			end
		end
		if foundPlayer then
			local content = string.format("Strength: %s\nRebirths: %s\nKills: %s\nBrawls: %s\nGood Karma: %s\nEvil Karma: %s\nDurability: %s\nAgility: %s", formatNumber(foundPlayer.leaderstats.Strength.Value), formatNumber(foundPlayer.leaderstats.Rebirths.Value), formatNumber(foundPlayer.leaderstats.Kills.Value), formatNumber(foundPlayer.leaderstats.Brawls.Value), formatNumber(foundPlayer.goodKarma.Value), formatNumber(foundPlayer.evilKarma.Value), formatNumber(foundPlayer.Durability.Value), formatNumber(foundPlayer.Agility.Value))
			TrackingParagraph:SetContent(content)
			TrackingParagraph:SetTitle("ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã…  Tracking: " .. foundPlayer.Name)
		end
	end
}

local Section = Tabs.Killer:CreateSection("Auto Kill")
local Players = game:GetService("Players")

local function checkCharacter()
    if not game.Players.LocalPlayer.Character then
        repeat
            task.wait()
        until game.Players.LocalPlayer.Character
    end
    return game.Players.LocalPlayer.Character
end

local function killPlayer(target)
    local character = checkCharacter()
    if character and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        if character:FindFirstChild("LeftHand") then
            firetouchinterest(target.Character.HumanoidRootPart, character.LeftHand, 0)
            firetouchinterest(target.Character.HumanoidRootPart, character.LeftHand, 1)
            gettool()
        end
    end
end

Tabs.Killer:AddToggle("Kill Player", {
    Title = "Start Killing",
    Default = false,
    Callback = function(v)
        getgenv().killallv2 = v
        task.spawn(function()
            while getgenv().killallv2 do
                for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
                    if player ~= game.Players.LocalPlayer then
                        if player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
                            killPlayer(player)
                        end
                    end
                end
                task.wait()
            end
        end)
    end
})
local PlayerDropdown = Tabs.Killer:CreateDropdown("PlayerList", {
	Title = "Kill Target",
	Description = "Choose player to target",
	Values = {},
	Multi = false,
	Default = nil,
	Callback = function(Value)
		local username = string.match(Value, "(.+) |")
		targetPlayer = username
		print("Target set to:", targetPlayer)
	end
})

local function updatePlayerList()
	local playerInfo = {}
	for _, player in pairs(game:GetService("Players"):GetPlayers()) do
		if player ~= game.Players.LocalPlayer then
			local displayText = player.Name .. " | " .. player.DisplayName
			table.insert(playerInfo, displayText)
		end
	end
	PlayerDropdown:SetValues(playerInfo)
end

local IntSection = Tabs.Stats:CreateSection("â¬Player Statsâ¬")
local RunService = game:GetService("RunService")
local player = game.Players.LocalPlayer

local startTime = 0
local sessionStartTime = os.time()
local timerRunning = false

local strengthGained = 0
local lastStrengthValue = nil
local rebirthsGained = 0
local lastRebirthsValue = nil
local killsGained = 0
local lastKillsValue = nil
local brawlsGained = 0
local lastBrawlsValue = nil
local goodKarmaGained = 0
local lastGoodKarmaValue = nil
local evilKarmaGained = 0
local lastEvilKarmaValue = nil
local durabilityGained = 0
local lastDurabilityValue = nil
local agilityGained = 0
local lastAgilityValue = nil
local muscleKingTimeGained = 0
local lastMuscleKingTimeValue = nil

local TimerParagraph = Tabs.Stats:CreateParagraph("SessionTimer", {
    Title = "â±ï¸ Session Time",
    Content = "0d 0h 0m 0s",
    TitleAlignment = "Left",
    Acrylic = false,
    Theme = "Dark",
    ContentAlignment = Enum.TextXAlignment.Left
})

local CustomTimerParagraph = Tabs.Stats:CreateParagraph("CustomTimer", {
    Title = "â±ï¸ Custom Timer",
    Content = "Timer not started",
    TitleAlignment = "Left",
    Acrylic = false,
    Theme = "Dark",
    ContentAlignment = Enum.TextXAlignment.Left
})

local LeaderParagraph = Tabs.Stats:CreateParagraph("LeaderStats", {
    Title = "ðŸ“Š Leaderboard Stats",
    Content = "Loading stats...",
    TitleAlignment = "Left",
    Acrylic = false,
    Theme = "Dark",
    ContentAlignment = Enum.TextXAlignment.Left
})

local IntParagraph = Tabs.Stats:CreateParagraph("IntStats", {
    Title = "ðŸ’ª Player Stats",
    Content = "Loading stats...",
    TitleAlignment = "Left",
    Acrylic = false,
    Theme = "Dark",
    ContentAlignment = Enum.TextXAlignment.Left
})

Tabs.Stats:CreateButton{
    Title = "Start/Stop Timer",
    Description = "Track your training sessions",
    Callback = function()
        if not timerRunning then
            startTime = os.time()
            timerRunning = true
            CustomTimerParagraph:SetContent("Timer running...")
        else
            timerRunning = false
            CustomTimerParagraph:SetContent("Timer stopped")
        end
    end
}

local function formatNumber(number)
    local formatted = tostring(math.floor(number))
    local k
    while true do
        formatted, k = string.gsub(formatted, "^(-?%d+)(%d%d%d)", '%1,%2')
        if k == 0 then
            break
        end
    end
    return formatted
end

local function formatTime(seconds)
    local days = math.floor(seconds / 86400)
    local hours = math.floor((seconds % 86400) / 3600)
    local minutes = math.floor((seconds % 3600) / 60)
    local secs = seconds % 60
    return string.format("%dd %dh %dm %ds", days, hours, minutes, secs)
end

local function debugPrint(message, value)
    print(string.format("[DEBUG] %s: %s", message, tostring(value)))
end

repeat
    task.wait()
until game:IsLoaded()
debugPrint("")

if not player.Character then
    player.CharacterAdded:Wait()
end
debugPrint("Character Loaded", "Success")

repeat
    task.wait()
until player:FindFirstChild("leaderstats") and player:FindFirstChild("goodKarma")
debugPrint("")

RunService.RenderStepped:Connect(function()
    local sessionTime = os.time() - sessionStartTime
    TimerParagraph:SetContent(formatTime(sessionTime))
    if timerRunning then
        local elapsed = os.time() - startTime
        CustomTimerParagraph:SetContent(formatTime(elapsed))
    end
    local currentStrength = player.leaderstats.Strength.Value
    local currentRebirths = player.leaderstats.Rebirths.Value
    local currentKills = player.leaderstats.Kills.Value
    local currentBrawls = player.leaderstats.Brawls.Value
    local currentGoodKarma = player.goodKarma.Value
    local currentEvilKarma = player.evilKarma.Value
    local currentDurability = player.Durability.Value
    local currentAgility = player.Agility.Value
    local currentMuscleKingTime = player.muscleKingTime.Value
    if lastStrengthValue == nil then
        lastStrengthValue = currentStrength
    elseif currentStrength > lastStrengthValue then
        strengthGained = strengthGained + (currentStrength - lastStrengthValue)
    end
    lastStrengthValue = currentStrength
    if lastRebirthsValue == nil then
        lastRebirthsValue = currentRebirths
    elseif currentRebirths > lastRebirthsValue then
        rebirthsGained = rebirthsGained + (currentRebirths - lastRebirthsValue)
    end
    lastRebirthsValue = currentRebirths
    if lastKillsValue == nil then
        lastKillsValue = currentKills
    elseif currentKills > lastKillsValue then
        killsGained = killsGained + (currentKills - lastKillsValue)
    end
    lastKillsValue = currentKills
    if lastBrawlsValue == nil then
        lastBrawlsValue = currentBrawls
    elseif currentBrawls > lastBrawlsValue then
        brawlsGained = brawlsGained + (currentBrawls - lastBrawlsValue)
    end
    lastBrawlsValue = currentBrawls
    if lastGoodKarmaValue == nil then
        lastGoodKarmaValue = currentGoodKarma
    elseif currentGoodKarma > lastGoodKarmaValue then
        goodKarmaGained = goodKarmaGained + (currentGoodKarma - lastGoodKarmaValue)
    end
    lastGoodKarmaValue = currentGoodKarma
    if lastEvilKarmaValue == nil then
        lastEvilKarmaValue = currentEvilKarma
    elseif currentEvilKarma > lastEvilKarmaValue then
        evilKarmaGained = evilKarmaGained + (currentEvilKarma - lastEvilKarmaValue)
    end
    lastEvilKarmaValue = currentEvilKarma
    if lastDurabilityValue == nil then
        lastDurabilityValue = currentDurability
    elseif currentDurability > lastDurabilityValue then
        durabilityGained = durabilityGained + (currentDurability - lastDurabilityValue)
    end
    lastDurabilityValue = currentDurability
    if lastAgilityValue == nil then
        lastAgilityValue = currentAgility
    elseif currentAgility > lastAgilityValue then
        agilityGained = agilityGained + (currentAgility - lastAgilityValue)
    end
    lastAgilityValue = currentAgility
    if lastMuscleKingTimeValue == nil then
        lastMuscleKingTimeValue = currentMuscleKingTime
    elseif currentMuscleKingTime > lastMuscleKingTimeValue then
        muscleKingTimeGained = muscleKingTimeGained + (currentMuscleKingTime - lastMuscleKingTimeValue)
    end
    lastMuscleKingTimeValue = currentMuscleKingTime
    LeaderParagraph:SetContent(string.format("Strength: %s    Strength Gained: %s\nRebirths: %s     Rebirths Gained: %s\nKills: %s     Kills Gained: %s\nBrawls: %s     Brawls Gained: %s", formatNumber(currentStrength), formatNumber(strengthGained), formatNumber(currentRebirths), formatNumber(rebirthsGained), formatNumber(currentKills), formatNumber(killsGained), formatNumber(currentBrawls), formatNumber(brawlsGained)))
    IntParagraph:SetContent(string.format("Good Karma: %s     Gained: %s\nEvil Karma: %s     Gained: %s\nDurability: %s     Gained: %s\nAility: %s     Gained: %s\nMuscle King Time: %s     Gained: %s", formatNumber(currentGoodKarma), formatNumber(goodKarmaGained), formatNumber(currentEvilKarma), formatNumber(evilKarmaGained), formatNumber(currentDurability), formatNumber(durabilityGained), formatNumber(currentAgility), formatNumber(agilityGained), formatNumber(currentMuscleKingTime), formatNumber(muscleKingTimeGained)))
end)

local leaderStats = {
    "Strength",
    "Rebirths",
    "Kills",
    "Brawls"
}

local intStats = {
    "Agility",
    "Durability",
    "Gems",
    "evilKarma",
    "goodKarma",
    "muscleKingTime"
}

----killl bad and good---
local Section = Tabs.Killer:CreateSection("â¬Auto Kill Karmaâ¬")

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Equip Punch tool
local function equipTool(toolName)
    local character = LocalPlayer.Character
    local backpack = LocalPlayer.Backpack
    if not (character and backpack) then return end
    local tool = backpack:FindFirstChild(toolName)
    if tool then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:EquipTool(tool)
        end
    end
end

-- Evil Karma Kill function (targets players with more Evil Karma than Good Karma)
local function evilKarmaKill(toggleState)
    getgenv().killEvil = toggleState
    if toggleState then
        equipTool("Punch")
        task.spawn(function()
            while getgenv().killEvil do
                local character = LocalPlayer.Character
                local leftHand = character and character:FindFirstChild("LeftHand")
                if not leftHand then
                    task.wait(0.3)
                    continue
                end
                local muscleEvent = LocalPlayer:FindFirstChild("muscleEvent")
                if muscleEvent then
                    muscleEvent:FireServer("punch", "rightHand")
                    muscleEvent:FireServer("punch", "leftHand")
                end
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer then
                        local goodKarma = player:FindFirstChild("goodKarma")
                        local evilKarma = player:FindFirstChild("evilKarma")
                        if goodKarma and evilKarma and evilKarma.Value > goodKarma.Value then
                            local targetChar = player.Character
                            local head = targetChar and targetChar:FindFirstChild("Head")
                            if head then
                                head.CFrame = leftHand.CFrame
                                for _, part in pairs(targetChar:GetDescendants()) do
                                    if part:IsA("BasePart") and part.Name == "Handle" then
                                        part.CFrame = leftHand.CFrame
                                    end
                                end
                                local sweatPart = targetChar:FindFirstChild("sweatPart")
                                if sweatPart then
                                    sweatPart.CFrame = leftHand.CFrame
                                end
                            end
                        end
                    end
                end
                task.wait(.1)
            end
        end)
    end
end

-- Good Karma Kill function (targets players with more Good Karma than Evil Karma)
local function goodKarmaKill(toggleState)
    getgenv().killGood = toggleState
    if toggleState then
        equipTool("Punch")
        task.spawn(function()
            while getgenv().killGood do
                local character = LocalPlayer.Character
                local leftHand = character and character:FindFirstChild("LeftHand")
                if not leftHand then
                    task.wait(0.3)
                    continue
                end
                local muscleEvent = LocalPlayer:FindFirstChild("muscleEvent")
                if muscleEvent then
                    muscleEvent:FireServer("punch", "rightHand")
                    muscleEvent:FireServer("punch", "leftHand")
                end
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer then
                        local goodKarma = player:FindFirstChild("goodKarma")
                        local evilKarma = player:FindFirstChild("evilKarma")
                        if goodKarma and evilKarma and goodKarma.Value > evilKarma.Value then
                            local targetChar = player.Character
                            local head = targetChar and targetChar:FindFirstChild("Head")
                            if head then
                                head.CFrame = leftHand.CFrame
                                for _, part in pairs(targetChar:GetDescendants()) do
                                    if part:IsA("BasePart") and part.Name == "Handle" then
                                        part.CFrame = leftHand.CFrame
                                    end
                                end
                                local sweatPart = targetChar:FindFirstChild("sweatPart")
                                if sweatPart then
                                    sweatPart.CFrame = leftHand.CFrame
                                end
                            end
                        end
                    end
                end
                task.wait(.1)
            end
        end)
    end
end

Tabs.Killer:AddToggle("GoodKarmaKillToggle", {
    Title = "Good Karma Kill",
    Description = "Toggle to kill players with more Evil Karma",
    Default = false,
    Callback = function(state)
        evilKarmaKill(state)
        pcall(function()
            Library:Notify("Good Karma Kill " .. (state and "Enabled" or "Disabled"), 2)
        end)
    end
})

-- Evil Karma Kill toggle
Tabs.Killer:AddToggle("EvilKarmaKillToggle", {
    Title = "Evil Karma Kill",
    Description = "Toggle to kill players with more Good Karma",
    Default = false,
    Callback = function(state)
        goodKarmaKill(state)
        pcall(function()
            Library:Notify("Evil Karma Kill " .. (state and "Enabled" or "Disabled"), 2)
        end)
    end
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Function to get list of player DisplayNames
local function getPlayerList()
    local playerList = {}
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(playerList, player.DisplayName)
        end
    end
    return playerList
end

local Dropdown = Tabs.Killer:CreateDropdown("SpectatePlayer", {
    Title = "Spectate Player",
    Description = "Piliin ang player na panoorin",
    Options = getPlayerList(),
    Default = "",
    Callback = function(Value)
        local targetPlayer = nil
        for _, player in pairs(Players:GetPlayers()) do
            if player.DisplayName == Value then
                targetPlayer = player
                break
            end
        end
        if targetPlayer and targetPlayer.Character then
            local camera = workspace.CurrentCamera
            camera.CameraSubject = targetPlayer.Character.Humanoid
            print("Now spectating: " .. targetPlayer.DisplayName .. " (@" .. targetPlayer.Name .. ")")
        else
            print("Hindi mahanap ang player o walang character.")
        end
    end
})

-- Dynamically update dropdown
local function updatePlayerList()
    local newOptions = getPlayerList()
    Dropdown.Options = newOptions
    if Dropdown.SetValues then
        Dropdown:SetValues(newOptions)
    end
    print("Na-update ang dropdown: " .. table.concat(newOptions, ", "))
end

task.spawn(function()
    while true do
        updatePlayerList()
        task.wait(1)
    end
end)

Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)
updatePlayerList()

Tabs.Killer:CreateButton({
    Title = "Stop Spying",
    Description = "Bumalik ang camera sa iyong character",
    Callback = function()
        local camera = workspace.CurrentCamera
        if LocalPlayer.Character then
            camera.CameraSubject = LocalPlayer.Character.Humanoid
            print("Bumalik ang camera sa iyong character.")
        else
            print("Walang character ang iyong player.")
        end
    end
})


local currentRadius = 75
local RadiusInput = Tabs.Killer:CreateInput("RadiusInput", {
    Title = "Kill Aura Radius",
    Description = "Set the kill aura radius (1-150)",
    Default = "75",
    Placeholder = "Enter radius...",
    Callback = function(Value)
        currentRadius = math.clamp(tonumber(Value) or 75, 1, 150)
        Library:Notify({
            Title = "Radius Updated",
            Content = "Kill aura radius set to: " .. currentRadius,
            Duration = 2
        })
    end
})

local Toggle = Tabs.Killer:AddToggle("Kill Nearby", {
    Title = "Matrix Kill Aura",
    Default = false,
    Callback = function(v)
        getgenv().killNearby = v
        local radiusVisual = Instance.new("Part")
        radiusVisual.Anchored = true
        radiusVisual.CanCollide = false
        radiusVisual.Transparency = 0.8
        radiusVisual.Material = Enum.Material.ForceField
        radiusVisual.Color = Color3.fromRGB(0, 2, 255)
        radiusVisual.Size = Vector3.new(1, 0.1, 1)
        task.spawn(function()
            while getgenv().killNearby do
                pcall(function()
                    local myCharacter = Players.LocalPlayer.Character
                    local myRoot = myCharacter and myCharacter:FindFirstChild("HumanoidRootPart")
                    if myRoot then
                        radiusVisual.Parent = workspace
                        radiusVisual.Size = Vector3.new(currentRadius * 2, 0.1, currentRadius * 2)
                        radiusVisual.CFrame = myRoot.CFrame * CFrame.new(0, -2, 0)
                        for _, player in pairs(Players:GetPlayers()) do
                            if player ~= Players.LocalPlayer and not whitelist[player.Name] then
                                local char = player.Character
                                local root = char and char:FindFirstChild("HumanoidRootPart")
                                if root and myRoot then
                                    local distance = (root.Position - myRoot.Position).Magnitude
                                    if distance <= currentRadius then
                                        firetouchinterest(root, myCharacter.LeftHand, 0)
                                        task.wait()
                                        firetouchinterest(root, myCharacter.LeftHand, 1)
                                        gettool()
                                    end
                                end
                            end
                        end
                        task.wait(0.1)
                    end
                end)
                task.wait(0.1)
            end
            radiusVisual:Destroy()
        end)
    end
})

local PlayerDropdown = Tabs.Killer:CreateDropdown("PlayerList", {
    Title = "Select Target",
    Description = "Choose player to target",
    Values = {},
    Multi = false,
    Default = nil,
    Callback = function(Value)
        local username = string.match(Value, "(.+) |")
        targetPlayer = username
        print("Target set to:", targetPlayer)
    end
})
