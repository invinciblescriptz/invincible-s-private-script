local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library"))()
local window = library:AddWindow("Invincibles Priv Script", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = false,
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local muscleEvent = LocalPlayer:WaitForChild("muscleEvent", 10)

-- Utility functions
local function getRebirthCount()
    local stat = LocalPlayer:FindFirstChild("leaderstats")
    if stat and stat:FindFirstChild("Rebirths") then
        return stat.Rebirths.Value
    end
    return 0
end

local function invokeRebirth()
    local success, err = pcall(function()
        local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
        if rEvents then
            local rebirthRemote = rEvents:FindFirstChild("rebirthRemote")
            if rebirthRemote then
                rebirthRemote:InvokeServer("rebirthRequest")
            end
        end
    end)
    if not success then
        print("Failed to invoke rebirth remote:", err)
    end
end

-- AUTO REBIRTH
local targetRebirthValue = 1
local autoRebirthActive = false

local function autoRebirthLoop()
    while autoRebirthActive do
        local current = getRebirthCount()
        if current >= targetRebirthValue then
            print("Target rebirth reached: " .. current)
            autoRebirthActive = false
            break
        end
        invokeRebirth()
        wait(0.5)
    end
end

local function toggleAutoRebirth(state)
    autoRebirthActive = state
    if state then
        task.spawn(autoRebirthLoop)
    end
end

-- UI for Rebirth
local rebirthTab = window:AddTab("Rebirth")
local toggleRebirth = rebirthTab:AddToggle("Auto Rebirth to Target", {
    Default = false,
    Callback = toggleAutoRebirth
})

local inputRebirthTarget = rebirthTab:AddInput("TargetRebirth", {
    Default = "1",
    Placeholder = "Enter target rebirth",
    Callback = function(val)
        local num = tonumber(val)
        if num then targetRebirthValue = num end
    end
})

rebirthTab:AddButton("Rebirth Now", function()
    invokeRebirth()
end)

local function updateRebirthStats()
    local current = getRebirthCount()
    local initial = 0
    if game.Players.LocalPlayer:FindFirstChild("leaderstats") then
        if game.Players.LocalPlayer.leaderstats:FindFirstChild("Rebirths") then
            initial = game.Players.LocalPlayer.leaderstats.Rebirths.Value
        end
    end
    local gained = current - initial
    if Paragraph then
        Paragraph:SetContent("Target: " .. targetRebirthValue .. "\nCurrent: " .. current .. "\nGained: " .. gained)
    end
end

local Paragraph = rebirthTab:AddParagraph("RebirthStats", {
    Title = "Rebirth Stats",
    Content = "Loading...",
    TitleAlignment = "Left",
    ContentAlignment = Enum.TextXAlignment.Left
})

game:GetService("RunService").RenderStepped:Connect(updateRebirthStats)

-- ROCKS for farming
local rockNames = {
    {name = "TinyIslandRock", title = "Tiny Island Rock"},
    {name = "StarterIslandRock", title = "Starter Island Rock"},
    {name = "LegendBeachRock", title = "Legend Beach Rock"},
    {name = "FrostGymRock", title = "Frost Gym Rock"},
    {name = "MythicalGymRock", title = "Mythical Gym Rock"},
}

local farming = false

local function farmRock(rockName)
    local rock = workspace:FindFirstChild(rockName)
    if not rock then
        print("Rock not found: " .. rockName)
        return
    end
    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then
        print("HumanoidRootPart not found")
        return
    end
    hrp.CFrame = rock.CFrame * CFrame.new(0, 0, -3)
    wait(0.5)
    local rockPart = rock:FindFirstChildWhichIsA("BasePart")
    if not rockPart then
        print("Rock part not found in: " .. rockName)
        return
    end
    firetouchinterest(hrp, rockPart, 0)
    firetouchinterest(hrp, rockPart, 1)
    print("Farmed " .. rockName)
end

local function startFarming(rockName)
    if _G.farming then return end
    _G.farming = true
    task.spawn(function()
        while _G.farming do
            farmRock(rockName)
            wait(5)
        end
    end)
end

local function stopFarming()
    _G.farming = false
end

-- Create "Rocks" tab and add all rocks
local RockTab = window:AddTab("Rocks")
for _, rock in ipairs(rockNames) do
    RockTab:AddButton("Farm " .. rock.title, function()
        startFarming(rock.name)
    end)
end
RockTab:AddButton("Stop Farming", function()
    stopFarming()
end)
