local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library", true))()
local window = library:AddWindow("Invincibles Priv Script", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = false,
})

local main = window:AddTab("Main")
local Tools = main:AddFolder("Tools")
local Rocks = main:AddFolder("Rocks")

-- Helper: Auto-rep (unchanged, solid)
local function startAutoRep(toolName, toggleVar)
    task.spawn(function()
        while _G[toggleVar] do
            local player = game.Players.LocalPlayer
            local character = player.Character or player.CharacterAdded:Wait()
            if not character or not character:FindFirstChild("Humanoid") then
                task.wait(1)
                continue
            end

            -- Auto-equip tool
            local tool = player.Backpack:FindFirstChild(toolName) or character:FindFirstChild(toolName)
            if tool and tool.Parent ~= character then
                character.Humanoid:EquipTool(tool)
            end

            -- Fire rep event
            local muscleEvent = player:FindFirstChild("muscleEvent")
            if muscleEvent then
                muscleEvent:FireServer("rep")
            end

            task.wait(0.025)
        end

        -- Cleanup: unequip on disable
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character then
            local equipped = character:FindFirstChild(toolName)
            if equipped then
                equipped.Parent = player.Backpack
            end
        end
    end)
end

-- Auto training switches
Tools:AddSwitch("Auto Pushups", function(state)
    _G.AutoPushups = state
    if state then startAutoRep("Pushups", "AutoPushups") end
end)

Tools:AddSwitch("Auto Weight", function(state)
    _G.AutoWeight = state
    if state then startAutoRep("Weight", "AutoWeight") end
end)

Tools:AddSwitch("Auto Handstands", function(state)
    _G.AutoHandstands = state
    if state then startAutoRep("Handstands", "AutoHandstands") end
end)

-- Fast Punch (improved stability + check both hands)
Tools:AddSwitch("Fast Punch", function(state)
    _G.FastPunch = state
    if state then
        -- Cooldown bypass loop
        task.spawn(function()
            while _G.FastPunch do
                local player = game.Players.LocalPlayer
                local punch = player.Backpack:FindFirstChild("Punch") or (player.Character and player.Character:FindFirstChild("Punch"))
                if punch and punch:FindFirstChild("attackTime") then
                    punch.attackTime.Value = 0
                end
                task.wait(0.25)
            end
        end)

        -- Spam punch event + activate
        task.spawn(function()
            while _G.FastPunch do
                local player = game.Players.LocalPlayer
                local muscleEvent = player:FindFirstChild("muscleEvent")
                if muscleEvent then
                    muscleEvent:FireServer("punch", "rightHand")
                    muscleEvent:FireServer("punch", "leftHand")
                end
                local char = player.Character
                if char and char:FindFirstChild("Punch") then
                    char.Punch:Activate()
                end
                task.wait(0.07)  -- Slightly more stable (most 2026 servers handle ~14–15/s)
            end
        end)
    end
end)

-- Anti-Lag (unchanged, very effective)
Tools:AddButton("Anti Lag (Boost FPS)", function()
    local Lighting = game:GetService("Lighting")
    local Workspace = game:GetService("Workspace")

    Lighting.GlobalShadows = false
    Lighting.Brightness = 1
    Lighting.ClockTime = 12
    Lighting.FogEnd = 9999
    Lighting.FogStart = 0

    for _, v in pairs(Workspace:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Smoke") or v:IsA("Fire") or v:IsA("Sparkles") or
           v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("DepthOfFieldEffect") or v:IsA("SunRaysEffect") then
            v.Enabled = false
        end
    end

    settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    print("Anti-Lag activated → check FPS (Shift+F5)")
end)

-- Improved Ancient Jungle Rock Auto-Farm (10M durability confirmed working in recent sources)
Rocks:AddSwitch("Auto Farm Ancient Jungle Rock (10M)", function(state)
    getgenv().autoFarmRock = state
    getgenv().targetRockName = "Ancient Jungle Rock"
    getgenv().targetDurability = 10000000  -- Standard for Ancient Jungle in 2025–2026

    task.spawn(function()
        while getgenv().autoFarmRock do
            local player = game.Players.LocalPlayer
            local char = player.Character
            if not char or not char:FindFirstChild("HumanoidRootPart") or not player:FindFirstChild("Durability") then
                task.wait(1.5)
                continue
            end

            if player.Durability.Value < getgenv().targetDurability then
                task.wait(2)  -- Wait longer if durability too low
                continue
            end

            local hrp = char.HumanoidRootPart
            local found = false

            for _, obj in pairs(game.Workspace.machinesFolder:GetDescendants()) do
                if obj:IsA("IntValue") and obj.Name == "neededDurability" 
                   and obj.Value == getgenv().targetDurability
                   and obj.Parent and obj.Parent:FindFirstChild("Rock")
                   and (getgenv().targetRockName == "" or obj.Parent.Rock.Name == getgenv().targetRockName) then

                    local rock = obj.Parent.Rock
                    local distance = (hrp.Position - rock.Position).Magnitude

                    if distance > 10 then  -- Only teleport if meaningfully far (anti-rubberband)
                        hrp.CFrame = rock.CFrame * CFrame.new(0, 3.5, -1.5)  -- Better offset for punch hitbox
                        found = true
                        task.wait(0.12)  -- Brief settle
                    end
                end
            end

            task.wait(found and 0.35 or 1.2)  -- Faster when active, slower when searching
        end

        -- Cleanup on disable: return to safe-ish spawn area
        local player = game.Players.LocalPlayer
        local char = player.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            char.HumanoidRootPart.CFrame = CFrame.new(-10, 10, -200)  -- Approx spawn island safe spot
        end
    end)
end)
