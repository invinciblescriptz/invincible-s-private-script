local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library"))()
local window = library:AddWindow("Invincibles Priv Script", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = false,
})

local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Wait for muscleEvent to exist
local muscleEvent
task.spawn(function()
    repeat
        muscleEvent = LP:FindFirstChild("muscleEvent") or workspace:FindFirstChild("muscleEvent")
        wait(1)
    until muscleEvent
    print("muscleEvent found:", muscleEvent)
end)

-- Utility: firetouchinterest (some exploits might already have it)
local function fireTouch(part1, part2, toggle)
    if firetouchinterest then
        firetouchinterest(part1, part2, toggle)
    else
        -- fallback if needed
        print("firetouchinterest not found")
    end
end

-- Teleport function
local function tpTo(pos)
    local hrp = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
    if hrp then
        hrp.CFrame = CFrame.new(pos)
        print("Teleported to", pos)
    end
end

-- UI Tabs
local main = window:AddTab("Main")
local ToolsFolder = main:AddFolder("Tools")
local TeleportTab = window:AddTab("Teleport")
local KillTab = main:AddTab("Kill")
local MiscTab = main:AddTab("Misc")
local rebirthTab = main:AddTab("Rebirth")
local farmTab = main:AddTab("Auto Farm")

-- Teleports
TeleportTab:AddButton("To Spawn / Safe", function() tpTo(Vector3.new(-6, 5, -196)) end)
TeleportTab:AddButton("To Secret Area", function() tpTo(Vector3.new(1947, 2, 6191)) end)
-- add more teleports as needed

-- Auto Rebirth
local autoRebirth = false
local function autoRebirthLoop()
    while autoRebirth do
        pcall(function()
            local rEvents = ReplicatedStorage:FindFirstChild("rEvents")
            if rEvents and rEvents:FindFirstChild("rebirthRemote") then
                rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                print("Rebirth requested")
            end
        end)
        wait(0.1)
    end
end

rebirthTab:AddSwitch("Auto Rebirth", function(state)
    autoRebirth = state
    if state then task.spawn(autoRebirthLoop) end
end)

-- Kill all players
local killAll = false
local function killLoop()
    while killAll do
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LP and plr.Character then
                local hrp = plr.Character:FindFirstChild("HumanoidRootPart")
                local myHRP = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
                if hrp and myHRP then
                    fireTouch(hrp, myHRP, 0)
                    fireTouch(hrp, myHRP, 1)
                end
            end
        end
        wait(0.1)
    end
end

local killFolder = KillTab:AddFolder("Auto Kill")
killFolder:AddSwitch("Kill All Players", function(state)
    killAll = state
    if state then task.spawn(killLoop) end
end)

local targetName = nil
local dropdown = killFolder:AddDropdown("Target Player", {
    Values = {},
    Callback = function(val)
        targetName = val
    end
})

killFolder:AddSwitch("Auto Kill Target", function(state)
    getg().autoKillTarget = state
    if state and targetName then
        task.spawn(function()
            while getg().autoKillTarget do
                local tgt = Players:FindFirstChild(targetName)
                if tgt then
                    local hrp = tgt.Character and tgt.Character:FindFirstChild("HumanoidRootPart")
                    local myHRP = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and myHRP then
                        fireTouch(hrp, myHRP, 0)
                        fireTouch(hrp, myHRP, 1)
                    end
                end
                wait(0.08)
            end
        end)
    end
end)

-- Update dropdown list of players
task.spawn(function()
    while true do
        local list = {}
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LP then
                table.insert(list, plr.Name)
            end
        end
        pcall(function()
            dropdown:SetValues(list)
        end)
        wait(5)
    end
end)

-- Infinite Jump
MiscTab:AddSwitch("Infinite Jump", function(state)
    getg().infJump = state
end)
UserInputService.JumpRequest:Connect(function()
    if getg().infJump and LP.Character then
        LP.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)

-- Auto farm rocks
local autoFarm = false
local targetDurability = 0
local function autoFarmRocks(durability)
    while autoFarm do
        for _, v in pairs(workspace:FindFirstChild("machinesFolder") and workspace.machinesFolder:GetDescendants() or {}) do
            if v.Name == "neededDurability" and v.Value == durability then
                local rock = v.Parent and v.Parent:FindFirstChild("Rock")
                local char = LP.Character
                if rock and char and char:FindFirstChild("RightHand") and char:FindFirstChild("LeftHand") then
                    fireTouch(rock, char.RightHand, 0)
                    fireTouch(rock, char.RightHand, 1)
                    fireTouch(rock, char.LeftHand, 0)
                    fireTouch(rock, char.LeftHand, 1)
                    -- Punch while farming
                    if _G.FastPunch then
                        if muscleEvent then
                            muscleEvent:FireServer("punch", "rightHand")
                            muscleEvent:FireServer("punch", "leftHand")
                        end
                        local punch = char:FindFirstChild("Punch")
                        if punch then punch:Activate() end
                    end
                end
            end
        end
        wait(0.15)
    end
end

local RockFarmFolder = farmTab:AddFolder("Rock Farm")
RockFarmFolder:AddSwitch("Farm Rock (durability 0)", {
    Default = false,
    Callback = function(val)
        autoFarm = val
        if val then autoFarmRocks(0) end
    end
})

-- Fast Punch with auto-equip
Tools:AddSwitch("Fast Punch", function(state)
    _G.FastPunch = state
    if state then
        task.spawn(function()
            local function equipPunch()
                local ch = LP.Character
                if not ch then return end
                local punch = LP.Backpack:FindFirstChild("Punch")
                if punch then
                    punch.Parent = ch
                end
            end
            equipPunch()
            while _G.FastPunch do
                pcall(function()
                    if muscleEvent then
                        muscleEvent:FireServer("punch", "rightHand")
                        muscleEvent:FireServer("punch", "leftHand")
                    end
                    local ch = LP.Character
                    if not ch:FindFirstChild("Punch") then
                        local punch = LP.Backpack:FindFirstChild("Punch")
                        if punch then punch.Parent = ch end
                    end
                    local punch = ch:FindFirstChild("Punch")
                    if punch then punch:Activate() end
                end)
                wait(0.07)
            end
        end)
    end
end)
