local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library"))()
local window = library:AddWindow("Invincibles Priv Script", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(470, 470),
    can_resize = false,
})

local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local workspace = game:GetService("Workspace")
local RS = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

-- Wait for muscleEvent
local muscleEvent
task.spawn(function()
    repeat
        muscleEvent = LP:FindFirstChild("muscleEvent") or workspace:FindFirstChild("muscleEvent")
        wait(1)
    until muscleEvent
    print("muscleEvent found:", muscleEvent)
end)

-- Helper: firetouchinterest
local function fireTouch(part1, part2, toggle)
    if firetouchinterest then
        firetouchinterest(part1, part2, toggle)
    end
end

-- Function to get Punch tool equipped
local function gettool()
    for _, v in pairs(LP.Backpack:GetChildren()) do
        if v.Name == "Punch" then
            LP.Character.Humanoid:EquipTool(v)
            break
        end
    end
    -- Fire punch commands
    if muscleEvent then
        muscleEvent:FireServer("punch", "leftHand")
        muscleEvent:FireServer("punch", "rightHand")
    end
end

-- Storage for toggle states
local farmingStates = {
    ["Tiny Island"] = false,
    ["Starter Island"] = false,
    ["Legend Beach"] = false,
    ["Frost Gym"] = false,
    ["Mythical Gym"] = false,
}

-- Farming function
local function farmAtDurability(durability, toggleName)
    while farmingStates[toggleName] do
        wait()
        local currentDurability = LP:WaitForChild("Durability").Value
        if currentDurability >= durability then
            for _, v in pairs(workspace:WaitForChild("machinesFolder"):GetDescendants()) do
                if v.Name == "neededDurability" and v.Value == durability then
                    local rock = v.Parent:FindFirstChild("Rock")
                    local char = LP.Character
                    if rock and char and char:FindFirstChild("RightHand") and char:FindFirstChild("LeftHand") then
                        fireTouch(rock, char.RightHand, 0)
                        fireTouch(rock, char.RightHand, 1)
                        fireTouch(rock, char.LeftHand, 0)
                        fireTouch(rock, char.LeftHand, 1)
                        gettool() -- equip punch before fighting
                        -- Punch while farming
                        if _G.FastPunch then
                            muscleEvent:FireServer("punch", "leftHand")
                            muscleEvent:FireServer("punch", "rightHand")
                        end
                    end
                end
            end
        end
    end
end

-- Create toggles for each location
local farmFolder = window:AddTab("Main"):AddFolder("Rock Farm")

local locations = {
    {name = "Tiny Island", durability = 0},
    {name = "Starter Island", durability = 100},
    {name = "Legend Beach", durability = 5000},
    {name = "Frost Gym", durability = 150000},
    {name = "Mythical Gym", durability = 400000},
}

for _, loc in ipairs(locations) do
    farmFolder:AddToggle("Farm " .. loc.name, {
        Default = false,
        Callback = function(state)
            farmingStates[loc.name] = state
            if state then
                task.spawn(function() farmAtDurability(loc.durability, loc.name) end)
            end
        end
    })
end
